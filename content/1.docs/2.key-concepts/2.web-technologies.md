::callout{type="info"}
В этом разделе описывается интеграция веб-технологий (HTML, CSS, JavaScript) в движок Wudgine с помощью Ultralight.
::

## Обзор

Wudgine использует библиотеку Ultralight для интеграции веб-технологий в игровой движок. Это позволяет создавать пользовательские интерфейсы, HUD и другие элементы с использованием стандартных веб-технологий.

![Веб-интерфейс в Wudgine](/images/web-ui-example.png)

## Преимущества использования веб-технологий

::card-group
  :::card{icon="i-lucide-code" title="Знакомые технологии"}
  Используйте HTML, CSS и JavaScript для создания UI вместо изучения новых систем.
  :::
  :::card{icon="i-lucide-paintbrush" title="Гибкий дизайн"}
  Создавайте сложные и отзывчивые интерфейсы с помощью CSS.
  :::
  :::card{icon="i-lucide-refresh-cw" title="Быстрая итерация"}
  Изменяйте UI без перекомпиляции игры.
  :::
  :::card{icon="i-lucide-users" title="Доступность для дизайнеров"}
  Позволяет дизайнерам работать с UI без знания C++.
  :::
::

## Архитектура веб-подсистемы

Веб-подсистема Wudgine состоит из следующих компонентов:

1. **WebView** — компонент для отображения веб-содержимого
2. **JavaScript Bridge** — мост для взаимодействия между C++ и JavaScript
3. **Renderer Integration** — интеграция с системой рендеринга
4. **Input System** — обработка пользовательского ввода

```cpp
// Пример создания WebView
WebView webView = WebView::Create(800, 600);
webView.LoadURL("file:///assets/ui/main-menu.html");

// Регистрация JavaScript API
webView.SetJavaScriptCallback("startGame", [](const JSArgs& args) {
    // Запуск игры
    gameManager.startNewGame();
    return JSValue::Undefined();
});
```

## Создание UI с помощью HTML/CSS

### Базовая структура UI-файла

```html
<!-- assets/ui/main-menu.html -->
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Main Menu</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="menu-container">
        <h1 class="game-title">My Awesome Game</h1>
        
        <div class="menu-buttons">
            <button id="start-game">Start Game</button>
            <button id="options">Options</button>
            <button id="exit">Exit</button>
        </div>
    </div>
    
    <script src="main-menu.js"></script>
</body>
</html>
```

### Стилизация с помощью CSS

```css
/* assets/ui/styles.css */
body {
    margin: 0;
    padding: 0;
    font-family: 'Game Font', sans-serif;
    background-color: transparent;
    overflow: hidden;
    user-select: none;
}

.menu-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100vh;
    background: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.9));
}

.game-title {
    font-size: 48px;
    color: #ffcc00;
    text-shadow: 0 0 10px rgba(255, 204, 0, 0.5);
    margin-bottom: 50px;
}

.menu-buttons {
    display: flex;
    flex-direction: column;
    gap: 20px;
}

button {
    background-color: #333;
    color: white;
    border: 2px solid #ffcc00;
    padding: 15px 30px;
    font-size: 24px;
    border-radius: 5px;
    cursor: pointer;
    transition: all 0.3s ease;
    min-width: 200px;
}

button:hover {
    background-color: #ffcc00;
    color: #333;
    transform: scale(1.05);
}
```

### Интерактивность с помощью JavaScript

```javascript
// assets/ui/main-menu.js
document.addEventListener('DOMContentLoaded', () => {
    // Кнопка "Start Game"
    document.getElementById('start-game').addEventListener('click', () => {
        // Вызов C++ функции через JavaScript Bridge
        window.engine.startGame();
    });
    
    // Кнопка "Options"
    document.getElementById('options').addEventListener('click', () => {
        window.location.href = 'options.html';
    });
    
    // Кнопка "Exit"
    document.getElementById('exit').addEventListener('click', () => {
        window.engine.exitGame();
    });
    
    // Анимация появления меню
    const menuButtons = document.querySelectorAll('.menu-buttons button');
    menuButtons.forEach((button, index) => {
        button.style.opacity = '0';
        button.style.transform = 'translateY(20px)';
        
        setTimeout(() => {
            button.style.opacity = '1';
            button.style.transform = 'translateY(0)';
        }, 100 * (index + 1));
    });
});
```

## JavaScript Bridge

JavaScript Bridge позволяет взаимодействовать между C++ кодом и JavaScript:

::code-group
```cpp [C++ сторона]
// Регистрация C++ функций для вызова из JavaScript
WebView webView = WebView::Create(800, 600);

// Регистрация функции startGame
webView.SetJavaScriptCallback("startGame", [](const JSArgs& args) {
    gameManager.startNewGame();
    return JSValue::Undefined();
});

// Регистрация функции exitGame
webView.SetJavaScriptCallback("exitGame", [](const JSArgs& args) {
    application.quit();
    return JSValue::Undefined();
});

// Передача данных в JavaScript
JSObject globalObject = webView.GetGlobalObject();
globalObject["playerName"] = "Hero";
globalObject["playerLevel"] = 5;
globalObject["playerHealth"] = 100;
```

```javascript [JavaScript сторона]
// Вызов C++ функций из JavaScript
document.getElementById('start-button').addEventListener('click', () => {
    // Вызов C++ функции
    window.engine.startGame();
});

// Получение данных из C++
const playerName = window.playerName;
const playerLevel = window.playerLevel;
const playerHealth = window.playerHealth;

document.getElementById('player-info').textContent = 
    `${playerName} (Level ${playerLevel}) - HP: ${playerHealth}`;
```
::

## Компонент WebUI

Для интеграции веб-интерфейса в сцену используется компонент WebUI:

```cpp
// Создание сущности с компонентом WebUI
Entity uiEntity = world.createEntity();
auto& transform = uiEntity.addComponent<Transform>();
auto& webUI = uiEntity.addComponent<WebUI>();

// Настройка WebUI компонента
webUI.setSize(800, 600);
webUI.setURL("file:///assets/ui/hud.html");
webUI.setTransparentBackground(true);
webUI.setInteractive(true);

// Регистрация обработчика событий
webUI.setEventCallback([](const WebUIEvent& event) {
    if (event.type == WebUIEventType::Message && event.message == "use_item") {
        int itemId = event.data["itemId"].GetInt();
        inventory.useItem(itemId);
    }
});
```

## Отладка веб-интерфейсов

Wudgine предоставляет инструменты для отладки веб-интерфейсов:

::list{type="primary"}
- **Инспектор элементов**: просмотр и редактирование DOM и CSS
- **Консоль JavaScript**: выполнение JavaScript кода и просмотр ошибок
- **Сетевой монитор**: отслеживание загрузки ресурсов
- **Отладка в реальном времени**: изменения применяются мгновенно
::

```cpp
// Включение инструментов разработчика
WebViewConfig config;
config.enableDevTools = true;
WebView webView = WebView::Create(800, 600, config);

// Открытие инструментов разработчика
webView.ShowDevTools();
```

## Оптимизация производительности

Рекомендации по оптимизации веб-интерфейсов:

::callout{type="warning"}
Веб-интерфейсы могут потреблять значительные ресурсы. Следуйте рекомендациям для обеспечения высокой производительности.
::

::list{type="success"}
- Минимизируйте количество DOM-элементов
- Избегайте сложных CSS-селекторов
- Оптимизируйте изображения и ресурсы
- Используйте CSS-анимации вместо JavaScript
- Ограничьте использование теней и фильтров
- Разделяйте сложные интерфейсы на несколько WebView
::

## Примеры использования

### Внутриигровой HUD

```html
<!-- assets/ui/hud.html -->
<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="hud.css">
</head>
<body>
    <div class="hud-container">
        <div class="health-bar">
            <div class="health-fill" id="health-fill"></div>
            <span class="health-text" id="health-text">100/100</span>
        </div>
        
        <div class="ammo-counter" id="ammo-counter">30/120</div>
        
        <div class="minimap" id="minimap"></div>
    </div>
    
    <script src="hud.js"></script>
</body>
</html>
```

### Инвентарь

```html
<!-- assets/ui/inventory.html -->
<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="inventory.css">
</head>
<body>
    <div class="inventory-grid" id="inventory-grid">
        <!-- Ячейки инвентаря будут добавлены через JavaScript -->
    </div>
    
    <div class="item-details" id="item-details">
        <h3 class="item-name">Выберите предмет</h3>
        <p class="item-description"></p>
        <div class="item-actions">
            <button id="use-item" disabled>Использовать</button>
            <button id="drop-item" disabled>Выбросить</button>
        </div>
    </div>
    
    <script src="inventory.js"></script>
</body>
</html>
```

## Следующие шаги

Теперь, когда вы ознакомились с веб-технологиями в Wudgine, рекомендуем:

::card-group
  :::card{icon="i-lucide-layout" title="Веб-интерфейсы" to="/5.web-interfaces/1.ui-overview"}
  Изучите подробнее создание пользовательских интерфейсов с помощью веб-технологий.
  :::
  :::card{icon="i-lucide-code" title="JavaScript API" to="/5.web-interfaces/2.javascript-api"}
  Познакомьтесь с JavaScript API для взаимодействия с движком.
  :::
::
